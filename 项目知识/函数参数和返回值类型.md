---
title: 函数参数和返回值类型
type: note
permalink: reference/函数参数和返回值类型
---

# 函数参数和返回值类型

## 数据类型概述

### VALUE_TYPE枚举
- `BOOLEAN` (0) - 布尔型 (true/false)
- `NUMBER` (1) - 数值型 (整数/小数)
- `TEXT` (2) - 文本型 (字符串)
- `DATE` (3) - 日期型 (Date对象)

## 算术运算符类型规则

### 加法 (+)
- 输入: 两个NUMBER类型 或 两个TEXT类型
- 输出: NUMBER类型 (如果输入是数值) 或 TEXT类型 (如果输入是字符串)
- 示例: `1 + 2` → NUMBER(3), `"Hello" + "World"` → TEXT("HelloWorld")

### 减法 (-)
- 输入: 两个NUMBER类型
- 输出: NUMBER类型
- 示例: `5 - 3` → NUMBER(2)

### 乘法 (*)
- 输入: 两个NUMBER类型
- 输出: NUMBER类型
- 示例: `3 * 4` → NUMBER(12)

### 除法 (/)
- 输入: 两个NUMBER类型
- 输出: NUMBER类型
- 示例: `10 / 2` → NUMBER(5.0)

### 取模 (%)
- 输入: 两个NUMBER类型
- 输出: NUMBER类型
- 示例: `10 % 3` → NUMBER(1)

### 幂运算 (^)
- 输入: 两个NUMBER类型
- 输出: NUMBER类型
- 示例: `2 ^ 3` → NUMBER(8.0)

## 比较运算符类型规则

### 等于 (=), 不等于 (<>)
- 输入: 两个相同类型 (NUMBER, TEXT, BOOLEAN, DATE)
- 输出: BOOLEAN类型
- 示例: `1 = 1` → BOOLEAN(true), `"abc" = "def"` → BOOLEAN(false)

### 大于 (>), 小于 (<), 大于等于 (>=), 小于等于 (<=)
- 输入: 两个NUMBER类型 或 两个TEXT类型 或 两个DATE类型
- 输出: BOOLEAN类型
- 示例: `5 > 3` → BOOLEAN(true), `"abc" > "abd"` → BOOLEAN(false)

## 逻辑运算符类型规则

### 逻辑与 (&&), 逻辑或 (||)
- 输入: 两个BOOLEAN类型
- 输出: BOOLEAN类型
- 示例: `true && false` → BOOLEAN(false)

### 逻辑非 (!)
- 输入: 一个BOOLEAN类型
- 输出: BOOLEAN类型
- 示例: `!true` → BOOLEAN(false)

## 按位运算符类型规则

### 按位与 (&), 按位或 (|), 按位异或 (^), 按位取反 (~)
- 输入: NUMBER类型 (会被转换为整数)
- 输出: NUMBER类型
- 示例: `5 & 3` → NUMBER(1)

## 方法函数类型规则

### IF函数
- 语法: `IF(条件, 真值, 假值)`
- 条件: 必须是BOOLEAN类型
- 真值和假值: 必须是相同类型 (NUMBER, TEXT, BOOLEAN, DATE)
- 输出: 与真值和假值相同的类型
- 示例: `IF(true, 1, 2)` → NUMBER(1), `IF(false, "yes", "no")` → TEXT("no")

### MAX函数
- 语法: `MAX(值1, 值2, ..., 值n)`
- 输入: 所有参数必须是NUMBER类型
- 输出: NUMBER类型
- 示例: `MAX(1, 2, 3)` → NUMBER(3)

### MIN函数
- 语法: `MIN(值1, 值2, ..., 值n)`
- 输入: 所有参数必须是NUMBER类型
- 输出: NUMBER类型
- 示例: `MIN(1, 2, 3)` → NUMBER(1)

### CONCAT函数
- 语法: `CONCAT(字符串1, 字符串2, ..., 字符串n)`
- 输入: 所有参数将被转换为TEXT类型
- 输出: TEXT类型
- 示例: `CONCAT("Hello", " ", "World")` → TEXT("Hello World")

### IN函数
- 语法: `IN(值, 值1, 值2, ..., 值n)`
- 输入: 所有参数必须是相同类型
- 输出: BOOLEAN类型
- 示例: `IN(1, 1, 2, 3)` → BOOLEAN(true)

### NOT_IN函数
- 语法: `NOT_IN(值, 值1, 值2, ..., 值n)`
- 输入: 所有参数必须是相同类型
- 输出: BOOLEAN类型
- 示例: `NOT_IN(5, 1, 2, 3)` → BOOLEAN(true)

### IS_NULL函数
- 语法: `IS_NULL(变量)`
- 输入: 变量引用 (Var类型)
- 输出: BOOLEAN类型
- 示例: `IS_NULL(I01N)` → BOOLEAN(false) (如果I01N存在)

## 三角函数类型规则

### COS函数
- 语法: `COS(弧度值)`
- 输入: NUMBER类型
- 输出: NUMBER类型
- 示例: `COS(0)` → NUMBER(1.0)

### SIN函数
- 语法: `SIN(弧度值)`
- 输入: NUMBER类型
- 输出: NUMBER类型
- 示例: `SIN(0)` → NUMBER(0.0)

## 数学函数类型规则

### POW函数
- 语法: `POW(底数, 指数)`
- 输入: 两个NUMBER类型
- 输出: NUMBER类型
- 示例: `POW(2, 3)` → NUMBER(8.0)

### SQRT函数
- 语法: `SQRT(数值)`
- 输入: NUMBER类型
- 输出: NUMBER类型
- 示例: `SQRT(4)` → NUMBER(2.0)

### ROUND_UP函数
- 语法: `ROUND_UP(数值, [精度])`
- 输入: 第一个参数为NUMBER类型，第二个参数(可选)为NUMBER类型
- 输出: NUMBER类型
- 示例: `ROUND_UP(1.2)` → NUMBER(2.0)

### ROUND_DOWN函数
- 语法: `ROUND_DOWN(数值, [精度])`
- 输入: 第一个参数为NUMBER类型，第二个参数(可选)为NUMBER类型
- 输出: NUMBER类型
- 示例: `ROUND_DOWN(1.7)` → NUMBER(1.0)

### HALF_UP函数
- 语法: `HALF_UP(数值, [精度])`
- 输入: 第一个参数为NUMBER类型，第二个参数(可选)为NUMBER类型
- 输出: NUMBER类型
- 示例: `HALF_UP(1.5)` → NUMBER(2.0)

### ROUNDSTEP函数
- 语法: `ROUNDSTEP(值, 步长)`
- 输入: 两个NUMBER类型
- 输出: NUMBER类型
- 示例: `ROUNDSTEP(1.234, 0.1)` → NUMBER(1.3)

## 日期函数类型规则

### DATE_ADD函数
- 语法: `DATE_ADD(类型, 数量, 日期)`
- 输入: NUMBER类型(类型), NUMBER类型(数量), DATE类型(日期)
- 输出: DATE类型
- 示例: `DATE_ADD(3, 1, TO_DATE("2023-01-01","yyyy-MM-dd"))` → DATE("2023-01-02 00:00:00")

### DATE_SUB函数
- 语法: `DATE_SUB(日期1, 日期2, [单位])`
- 输入: DATE类型, DATE类型, TEXT类型(可选，单位)
- 输出: NUMBER类型
- 示例: `DATE_SUB(TO_DATE("2023-01-02","yyyy-MM-dd"), TO_DATE("2023-01-01","yyyy-MM-dd"))` → NUMBER(1.0)

### DATE_FORMAT函数
- 语法: `DATE_FORMAT(日期, [格式])`
- 输入: DATE类型, TEXT类型(可选，格式)
- 输出: TEXT类型
- 示例: `DATE_FORMAT(TO_DATE("2023-01-01 12:30:45","yyyy-MM-dd HH:mm:ss"))` → TEXT("2023-01-01 12:30:45")

### TO_DATE函数
- 语法: `TO_DATE(字符串, [格式])`
- 输入: TEXT类型, TEXT类型(可选，格式)
- 输出: DATE类型
- 示例: `TO_DATE("2023-01-01","yyyy-MM-dd")` → DATE("2023-01-01 00:00:00")

### DATE_START函数
- 语法: `DATE_START(类型, 日期)`
- 输入: NUMBER类型(类型), DATE类型(日期)
- 输出: DATE类型
- 示例: `DATE_START(3, TO_DATE("2023-01-15 12:30:45","yyyy-MM-dd HH:mm:ss"))` → DATE("2023-01-15 00:00:00")

### DATE_END函数
- 语法: `DATE_END(类型, 日期)`
- 输入: NUMBER类型(类型), DATE类型(日期)
- 输出: DATE类型
- 示例: `DATE_END(3, TO_DATE("2023-01-15 12:30:45","yyyy-MM-dd HH:mm:ss"))` → DATE("2023-01-15 23:59:59")

### TO_NUM函数
- 语法: `TO_NUM(字符串)`
- 输入: TEXT类型
- 输出: NUMBER类型
- 示例: `TO_NUM("123")` → NUMBER(123.0)

## 窗口函数类型规则

### SUM函数
- 语法: `SUM(数值)`
- 输入: NUMBER类型
- 输出: NUMBER类型
- 示例: `SUM(I01N)` → NUMBER(所有I01N的总和)

### AVG函数
- 语法: `AVG(数值)`
- 输入: NUMBER类型
- 输出: NUMBER类型
- 示例: `AVG(I01N)` → NUMBER(所有I01N的平均值)

### COUNT函数
- 语法: `COUNT(任意)`
- 输入: 任意类型
- 输出: NUMBER类型
- 示例: `COUNT(*)` → NUMBER(元素总数)

## 类型转换规则

### 隐式类型转换
- 在需要时，NUMBER类型可以隐式转换为TEXT类型
- 布尔值true转换为数值1，false转换为数值0
- 数值可以转换为布尔值(0为false，非0为true)

### 显式类型转换函数
- `TO_NUM(字符串)` - 文本转数值
- `TO_DATE(字符串, [格式])` - 文本转日期
- 日期和时间操作可能会自动转换为文本用于显示

## 类型安全检查

### 编译时检查
- 函数参数类型检查
- 操作符操作数类型检查
- 变量引用类型检查

### 运行时检查
- 参数值有效性检查
- 溢出检查
- 除零检查