---
title: 运算符和函数语法参考
type: note
permalink: reference/运算符和函数语法参考
---

# 运算符和函数语法参考

## 算术运算符

### 加法 (+)
- 语法: `表达式 + 表达式`
- 示例: `1 + 2` → 3
- 示例: `"Hello" + "World"` → "HelloWorld"

### 减法 (-)
- 语法: `表达式 - 表达式`
- 示例: `5 - 3` → 2
- 示例: `0 - 5` → -5

### 乘法 (*)
- 语法: `表达式 * 表达式`
- 示例: `3 * 4` → 12
- 示例: `2.5 * 2` → 5.0

### 除法 (/)
- 语法: `表达式 / 表达式`
- 示例: `10 / 2` → 5.0
- 示例: `7 / 2` → 3.5

### 取模 (%)
- 语法: `表达式 % 表达式`
- 示例: `10 % 3` → 1
- 示例: `15 % 4` → 3

### 幂运算 (^)
- 语法: `表达式 ^ 表达式`
- 示例: `2 ^ 3` → 8.0
- 示例: `4 ^ 0.5` → 2.0

## 比较运算符

### 等于 (=)
- 语法: `表达式 = 表达式`
- 示例: `1 = 1` → true
- 示例: `"abc" = "abc"` → true

### 不等于 (<>)
- 语法: `表达式 <> 表达式`
- 示例: `1 <> 2` → true
- 示例: `"abc" <> "def"` → true

### 大于 (>)
- 语法: `表达式 > 表达式`
- 示例: `5 > 3` → true
- 示例: `2 > 5` → false

### 小于 (<)
- 语法: `表达式 < 表达式`
- 示例: `3 < 5` → true
- 示例: `5 < 3` → false

### 大于等于 (>=)
- 语法: `表达式 >= 表达式`
- 示例: `5 >= 5` → true
- 示例: `6 >= 5` → true

### 小于等于 (<=)
- 语法: `表达式 <= 表达式`
- 示例: `3 <= 5` → true
- 示例: `5 <= 5` → true

## 逻辑运算符

### 逻辑与 (&&)
- 语法: `表达式 && 表达式`
- 示例: `true && true` → true
- 示例: `true && false` → false

### 逻辑或 (||)
- 语法: `表达式 || 表达式`
- 示例: `true || false` → true
- 示例: `false || false` → false

### 逻辑非 (!)
- 语法: `!表达式`
- 示例: `!true` → false
- 示例: `!false` → true

## 按位运算符

### 按位与 (&)
- 语法: `表达式 & 表达式`
- 示例: `5 & 3` → 1 (二进制: 101 & 011 = 001)

### 按位或 (|)
- 语法: `表达式 | 表达式`
- 示例: `5 | 3` → 7 (二进制: 101 | 011 = 111)

### 按位异或 (^)
- 语法: `表达式 ^ 表达式`
- 示例: `5 ^ 3` → 6 (二进制: 101 ^ 011 = 110)

### 按位取反 (~)
- 语法: `~表达式`
- 示例: `~5` → -6

## 方法函数

### IF函数
- 语法: `IF(条件, 真值, 假值)`
- 示例: `IF(true, 1, 2)` → 1
- 示例: `IF(false, 1, 2)` → 2
- 示例: `IF(I01N > 0, I01N, 0)` → 如果I01N大于0则返回I01N，否则返回0

### MAX函数
- 语法: `MAX(值1, 值2, ..., 值n)`
- 示例: `MAX(1, 2, 3)` → 3
- 示例: `MAX(I01N, I02N, I03N)` → 返回三个变量中的最大值

### MIN函数
- 语法: `MIN(值1, 值2, ..., 值n)`
- 示例: `MIN(1, 2, 3)` → 1
- 示例: `MIN(I01N, I02N, I03N)` → 返回三个变量中的最小值

### CONCAT函数
- 语法: `CONCAT(字符串1, 字符串2, ..., 字符串n)`
- 示例: `CONCAT("Hello", " ", "World")` → "Hello World"
- 示例: `CONCAT(I01N, I02N)` → 将两个数字转为字符串并连接

### IN函数
- 语法: `IN(值, 值1, 值2, ..., 值n)`
- 示例: `IN(1, 1, 2, 3)` → true
- 示例: `IN(5, 1, 2, 3)` → false

### NOT_IN函数
- 语法: `NOT_IN(值, 值1, 值2, ..., 值n)`
- 示例: `NOT_IN(5, 1, 2, 3)` → true
- 示例: `NOT_IN(1, 1, 2, 3)` → false

### IS_NULL函数
- 语法: `IS_NULL(变量)`
- 示例: `IS_NULL(I01N)` → 如果I01N存在则返回false，否则返回true

## 三角函数

### COS函数
- 语法: `COS(弧度值)`
- 示例: `COS(0)` → 1.0 (cos(0) = 1)

### SIN函数
- 语法: `SIN(弧度值)`
- 示例: `SIN(0)` → 0.0 (sin(0) = 0)

## 数学函数

### POW函数
- 语法: `POW(底数, 指数)`
- 示例: `POW(2, 3)` → 8.0
- 示例: `POW(4, 0.5)` → 2.0

### SQRT函数
- 语法: `SQRT(数值)`
- 示例: `SQRT(4)` → 2.0
- 示例: `SQRT(9)` → 3.0

### ROUND_UP函数
- 语法: `ROUND_UP(数值, [精度])`
- 示例: `ROUND_UP(1.2)` → 2.0
- 示例: `ROUND_UP(1.234, 2)` → 1.24

### ROUND_DOWN函数
- 语法: `ROUND_DOWN(数值, [精度])`
- 示例: `ROUND_DOWN(1.7)` → 1.0
- 示例: `ROUND_DOWN(1.765, 2)` → 1.76

### HALF_UP函数
- 语法: `HALF_UP(数值, [精度])`
- 示例: `HALF_UP(1.5)` → 2.0
- 示例: `HALF_UP(2.5)` → 3.0

### ROUNDSTEP函数
- 语法: `ROUNDSTEP(值, 步长)`
- 示例: `ROUNDSTEP(1.234, 0.1)` → 1.3
- 示例: `ROUNDSTEP(1.234, 0.01)` → 1.24

## 日期函数

### DATE_ADD函数
- 语法: `DATE_ADD(类型, 数量, 日期)`
- 类型: 1=年, 2=月, 3=日, 4=小时, 5=分钟, 6=秒
- 示例: `DATE_ADD(3, 1, TO_DATE("2023-01-01","yyyy-MM-dd"))` → "2023-01-02 00:00:00"
- 示例: `DATE_ADD(1, 1, TO_DATE("2023-01-01","yyyy-MM-dd"))` → "2024-01-01 00:00:00"

### DATE_SUB函数
- 语法: `DATE_SUB(日期1, 日期2, [单位])`
- 单位: "SECOND", "MINUTE", "HOUR", "DAY" (默认为DAY)
- 示例: `DATE_SUB(TO_DATE("2023-01-02","yyyy-MM-dd"), TO_DATE("2023-01-01","yyyy-MM-dd"))` → 1.0
- 示例: `DATE_SUB(TO_DATE("2023-01-02 12:00:00","yyyy-MM-dd HH:mm:ss"), TO_DATE("2023-01-02 00:00:00","yyyy-MM-dd HH:mm:ss"), "HOUR")` → 12.0

### DATE_FORMAT函数
- 语法: `DATE_FORMAT(日期, [格式])`
- 默认格式: "yyyy-MM-dd HH:mm:ss"
- 示例: `DATE_FORMAT(TO_DATE("2023-01-01 12:30:45","yyyy-MM-dd HH:mm:ss"))` → "2023-01-01 12:30:45"
- 示例: `DATE_FORMAT(TO_DATE("2023-01-01 12:30:45","yyyy-MM-dd HH:mm:ss"), "yyyy-MM-dd")` → "2023-01-01"

### TO_DATE函数
- 语法: `TO_DATE(字符串, [格式])`
- 示例: `TO_DATE("2023-01-01","yyyy-MM-dd")` → 日期对象
- 示例: `TO_DATE("2023/01/01","yyyy/MM/dd")` → 日期对象

### DATE_START函数
- 语法: `DATE_START(类型, 日期)`
- 类型: 1=年开始, 2=月开始, 3=日开始, 4=周日开始, 5=周一开头
- 示例: `DATE_START(3, TO_DATE("2023-01-15 12:30:45","yyyy-MM-dd HH:mm:ss"))` → "2023-01-15 00:00:00"
- 示例: `DATE_START(2, TO_DATE("2023-01-15 12:30:45","yyyy-MM-dd HH:mm:ss"))` → "2023-01-01 00:00:00"

### DATE_END函数
- 语法: `DATE_END(类型, 日期)`
- 类型: 1=年结束, 2=月结束, 3=日结束, 4=周日结束, 5=周一结束
- 示例: `DATE_END(3, TO_DATE("2023-01-15 12:30:45","yyyy-MM-dd HH:mm:ss"))` → "2023-01-15 23:59:59"
- 示例: `DATE_END(2, TO_DATE("2023-01-15 12:30:45","yyyy-MM-dd HH:mm:ss"))` → "2023-01-31 23:59:59"

### TO_NUM函数
- 语法: `TO_NUM(字符串)`
- 示例: `TO_NUM("123")` → 123.0
- 示例: `TO_NUM("45.67")` → 45.67

## 窗口函数

### SUM函数
- 语法: `SUM(数值)`
- 示例: `SUM(I01N)` - 对列表中的所有I01N求和

### AVG函数
- 语法: `AVG(数值)`
- 示例: `AVG(I01N)` - 计算列表中所有I01N的平均值

### COUNT函数
- 语法: `COUNT(任意)`
- 示例: `COUNT(*)` - 计算列表中的元素数量

## 变量引用

### 数值变量
- 语法: `I01N`, `I02N`, `D01N`, `D02N` 等
- 示例: `I01N` - 引用名为I01N的数值变量

### 文本变量
- 语法: `T01T`, `T02T` 等
- 示例: `T01T` - 引用名为T01T的文本变量

### 布尔变量
- 语法: `B01B`, `B02B` 等
- 示例: `B01B` - 引用名为B01B的布尔变量

## 常量

### 布尔常量
- `true` - 真值
- `false` - 假值

### 数字常量
- `123` - 整数
- `123.45` - 小数

### 文本常量
- `"Hello World"` - 字符串，使用双引号包围

## 测试实践

### 运算符测试示例

在实际测试中，运算符的测试应该覆盖以下方面：

#### 正常情况测试
```java
@Test
public void 加法() {
    TestUtil.execute("1+1", 2);
}
```

#### 异常情况测试
```java
@Test
public void 加法编译失败() {
    TestUtil.compileFail("1+1+", "语法错误:[双目运算符缺少右边参数");
}
```

### 函数测试示例

#### 数学函数测试
```java
@Test
public void 正弦(){
    TestUtil.execute("ROUND_UP(SIN(1),4)",0.0175);
}
```

#### 日期函数测试
```java
@Test
public void 当前时间(){
    TestUtil.execute("TO_DATE()", new Date());
}
```

#### 字符串函数测试
```java
@Test
public void 字符串拼接() {
    TestUtil.execute("CONCAT(false,\"true\")", "falsetrue");
}
```

## 测试最佳实践

### 1. 使用描述性测试名称
使用中文描述性的测试方法名，清晰表明测试目的。

### 2. 覆盖边界条件
确保测试包括边界值、特殊输入和异常情况。

### 3. 验证错误处理
使用`compileFail`方法测试预期的编译错误。

### 4. 保持测试独立
每个测试应该独立运行，不依赖其他测试的结果。